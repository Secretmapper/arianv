<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head><link href="http://gmpg.org/xfn/11" rel="profile"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"><meta property="og:title" content="Arian Allenson's Portfolio"/><meta property="og:type" content="website" /><meta property="og:image" content="http://arianv.com/media/avatar.png"/><meta property="og:site_name" content="Arian Allenson's Portfolio"/><meta property="og:description" content="Game Developer a.k.a. Secretmapper"/><title>Turbo JS API: GSOC Weekly Update 5</title><link href='http://fonts.googleapis.com/css?family=Fjalla+One|Open+Sans:300' rel='stylesheet' type='text/css'><link rel="stylesheet" href="http://localhost:1313//css/main.css"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:1313/apple-touch-icon-144-precomposed.png"><link href="http://localhost:1313/favicon.png" rel="icon"><link href="" rel="alternate" type="application/rss+xml" title="Arian&#39;s Portfolio &middot; " /><meta name="description" content=""><meta name="keywords" content=""> </head><body><div class="content container"><div class="post"><h1 id="post-title">Turbo JS API: GSOC Weekly Update 5</h1> <span class="post-date">Jul 1, 2015 &middot; 2 minute read &middot; <a href="http://localhost:1313/post/Turbo-JS-API-Weekly-Update-5/#disqus_thread">Comments</a> </span><article> 

<p>This is the fifth weekly update for the <a href="https://github.com/osmlab/learnoverpass">LearnOverpass</a> Project.</p>

<p>This week&rsquo;s deliverable is to get started with the exercise engine of the project.</p>

<h2 id="tighter-integration:2e5c9c511ce57881c6b516ef04acc65b">Tighter Integration</h2>

<p>The bulk of the this week&rsquo;s workload was the creation of a Javascript API for <a href="https://github.com/tyrasd/overpass-turbo/commit/cbef8a38a55fd597d23f7014fe721ccd509ac9be">Overpass Turbo</a>.</p>

<p>Since the exercise engine is expected to be very interactive, it&rsquo;s a must to get Overpass Turbo&rsquo;s map and the Exercises to talk with each other in a tighter way than just changing the iframe&rsquo;s source <em>which has been used so far :P</em></p>

<p>Since the documentation site and turbo is in two different domains, simply accessing the content from the embedded iframe isn&rsquo;t possible because of security reasons.</p>

<p>Instead, CORS is used to expose certain methods and data. Users basically send a message through postMessage, an objet containing a command from the &lsquo;cmd&rsquo; property and parameters as an array through the &lsquo;value&rsquo; property.</p>

<p><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span style="color: #a6e22e">iframe</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">contentWindow</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">postMessage</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">JSON</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">stringify</span><span style="color: #f8f8f2">({</span>
  <span style="color: #a6e22e">cmd</span><span style="color: #f92672">:</span> <span style="color: #e6db74">&#39;run_query&#39;</span><span style="color: #f8f8f2">,</span>
  <span style="color: #a6e22e">value</span><span style="color: #f92672">:</span> <span style="color: #f8f8f2">[</span><span style="color: #e6db74">&#39;query&#39;</span><span style="color: #f8f8f2">]</span>
<span style="color: #f8f8f2">}),</span> <span style="color: #e6db74">&quot;*&quot;</span><span style="color: #f8f8f2">);</span>
</pre></div>
</p>

<p>Since postMessage only accepts strings, the command has to be JSON.stringify-ed, which is then parsed back by Turbo.</p>

<p>Apart from running queries, a special system was also put in place to be able to cache queries. It&rsquo;s a very little, silent addition, but something that I&rsquo;d imagine would improve UX significantly, caching samples and exercise answers.</p>

<h2 id="next-week:2e5c9c511ce57881c6b516ef04acc65b">Next Week</h2>

<p>Now that the API reference is complete, we&rsquo;re moving to a very exciting part of the project.</p>

<p>Two words: &lsquo;Interative Exercises&rsquo;</p>

<p>Thanks, as always, till next time!</p>
  <hr/><div class="post-series-desc"><p>This is a post in the <a href="http://localhost:1313//series/gsoc-2015" id="series"><b>GSOC 2015</b></a> series.<br/> Other posts in this series:</p>  <ul class="series"> <li>Jul 01, 2015 - <a href="http://localhost:1313/post/Turbo-JS-API-Weekly-Update-5/">Turbo JS API: GSOC Weekly Update 5</a></li> <li>Jun 24, 2015 - <a href="http://localhost:1313/post/Polishing-API-Reference-Weekly-Update-4/">Polishing API Reference: GSOC Weekly Update 4</a></li> <li>Jun 18, 2015 - <a href="http://localhost:1313/post/Porting-API-Reference-Weekly-Update-3/">Porting API Reference: GSOC Weekly Update 3</a></li> <li>Jun 11, 2015 - <a href="http://localhost:1313/post/Embedding-Overpass-Turbo-Weekly-Update-2/">Embedding Overpass Turbo: GSOC Weekly Update 2</a></li> <li>May 02, 2015 - <a href="http://localhost:1313/post/GSOC-2015-Introduction/">GSOC 2015 Introduction: LearnOverpass</a></li> </ul></div> </article> <div id="disqus_thread"></div></div></div> <script type="text/javascript">
var disqus_shortname = "arianv";
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>  <script type="text/javascript">
    var disqus_shortname = "arianv";
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>  <footer>Copyright &#169; Arian Allenson M. Valdez | CC-BY-SA</footer>  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', "UA-60507502-1", 'auto');
  ga('send', 'pageview');
</script> <script data-no-instant>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body></html>